@use "sass:math";
$card-min-width-horizontal: 70vw;
$card-min-height-vertical: 70vh;
$card-aspect-ratio: math.div(16, 9);
// $card-min-width: clamp(90rem, 50vw, 200rem);
$card-border-radius: 2rem;
$blur-size: 200px;

.card{
    width: $card-min-width-horizontal;
    height: calc($card-min-width-horizontal / $card-aspect-ratio);
    border-radius: $card-border-radius;
    // background-repeat: no-repeat;
    // background-size: cover;
    // background-position: center center;
    // background-image: var(--background);
    display: grid;
    padding: 3% 5%;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, 1fr);
    grid-template-areas: ". like"
               "title rating";
    color: white;
    font-size: 3rem;
    position: relative;



    @media (max-aspect-ratio: 1 / 1) {
        height: $card-min-height-vertical;
        width: calc($card-min-height-vertical * $card-aspect-ratio);
    }

    & > * {
        filter: drop-shadow(1px 1px 10px black);

        // text-shadow: 1px 1px 50px black;
    }

    .title{
        grid-area: title;
        align-self: end;
    }

    .like{
        grid-area: like;
        justify-self: end;
    }

    // .

    .rating{
        grid-area: rating;
        align-self: end;
        justify-self: end;
    }
    .bluredImage{
        border-radius: $card-border-radius;
        z-index: -2;
        content: '';
        position: absolute;
        background-repeat: no-repeat;
        background-size: cover;
        width: 100%;
        top: 0px;
        right: 0px;
        bottom: 0px;
        left: 0px;
        background-image: var(--background-blur);
        filter: blur($blur-size);
        transform-origin: center center;
        transform: scaleX(1.3) scaleY(2);
        transition: all 500ms ease-in-out;
    }
    
    .bluredImageEnter {
        filter: invert(0%) brightness(100%) contrast(100%) blur($blur-size);
    }
    
    .bluredImageEnterActive {
        animation: imageActive 300ms cubic-bezier(.85,.48,.85,.67) 0ms 2 alternate backwards;
        // transition: all 300ms cubic-bezier(.08,.26,.6,-0.31);
        // filter: invert(10%) brightness(120%) contrast(160%) blur($blur-size);
    }
    
    .bluredImageEnterDone{
        filter: invert(0%) brightness(100%) contrast(100%) blur($blur-size);
        animation: backgroundAnimation 3s ease-in-out 0ms infinite alternate forwards;
    }
    
    .bluredImageExit{
        transition: all 600ms ease-in-out;
        animation: backgroundAnimation 3s ease-in-out 0ms infinite alternate forwards;
        filter: invert(0%) brightness(100%) contrast(100%) blur($blur-size);
        
    }
    
    .bluredImageExitActive{
        filter: invert(0%) brightness(100%) contrast(100%) blur($blur-size);
        animation: none;        
    }
    
    &:hover .bluredImage {
        filter: invert(0%) brightness(200%) contrast(100%) blur($blur-size);
    }
    
    @keyframes imageActive {
        from{
            filter: invert(0%) brightness(100%) contrast(100%) blur($blur-size);
        }   
        to{
            filter: invert(10%) brightness(120%) contrast(160%) blur($blur-size);
        }     
    }

    @keyframes backgroundAnimation {
        from{
            filter: blur($blur-size) hue-rotate(0deg);
        } 25% {
            filter: blur($blur-size * 0.9) hue-rotate(25deg);
        } 75% {
            filter: blur($blur-size * 0.9) hue-rotate(-25deg);
        }
        to {
            filter: blur($blur-size) hue-rotate(0deg);
        }
    }


    &:after{
        z-index: -1;
        border-radius: $card-border-radius;

        display: block;
        position: absolute;
        content: "";
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center center;
        background-image: var(--background);
        opacity: var(--background-opacity);
    }
}